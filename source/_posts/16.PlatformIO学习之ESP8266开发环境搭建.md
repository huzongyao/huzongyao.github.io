---
title: PlatformIOå­¦ä¹ ä¹‹ESP8266å¼€å‘ç¯å¢ƒæ­å»º
date: 2020-08-26 17:04:14
tags:
- esp8266
- PlatformIO

categories:
- æŠ€æœ¯åšå®¢
- PlatformIOå­¦ä¹ 
---

PlatformIO æ˜¯å¼€æºçš„ç‰©è”ç½‘å¼€å‘ç”Ÿæ€ç³»ç»Ÿã€‚æä¾›è·¨å¹³å°çš„ä»£ç æ„å»ºå™¨ã€é›†æˆå¼€å‘ç¯å¢ƒï¼ˆIDEï¼‰ï¼Œå…¼å®¹ Arduinoï¼ŒESP8266å’Œmbedç­‰ã€‚æ”¯æŒåœ¨Windowsã€Linuxã€macOSä¸Šä½¿ç”¨é¢„ç¼–è¯‘å¥½çš„å·¥å…·é“¾ï¼Œè°ƒè¯•å™¨å’Œæ¡†æ¶è¿›è¡Œå¼€å‘ã€‚
<!--more-->
ä½¿ç”¨PlatformIOå¼€å‘åµŒå…¥å¼æœ‰å¾ˆå¤šæ–¹ä¾¿ä¹‹å¤„ï¼Œé¦–å…ˆPlatformIOä¸æ˜¯ç‹¬ç«‹çš„IDEï¼Œåªæ˜¯ä¸€ä¸ªVisualStudio Codeä¸­çš„ä¸€ä¸ªæ’ä»¶ï¼Œæ‰€ä»¥å®‰è£…éå¸¸æ–¹ä¾¿ï¼Œå¦‚æœç†Ÿæ‚‰ä½¿ç”¨VSCodeçš„è¯æ›´å¥½ã€‚
æ­¤å¤–PlatformIOä¸­å¯ä»¥ç»Ÿä¸€å®‰è£…åµŒå…¥å¼å¼€å‘çš„å¹³å°æ”¯æŒå’Œç±»åº“ï¼Œå…å»äº†é¢‘ç¹çš„ä¸‹è½½å’Œæ­å»ºå„ç§ç¼–è¯‘ç¯å¢ƒï¼Œå…å»äº†ç³»ç»Ÿä¸å…¼å®¹é€ æˆçš„éº»çƒ¦ã€‚å› ä¸ºè¿™äº›ç¼–è¯‘ç¯å¢ƒå’Œä¸Šä¼ è°ƒè¯•å·¥å…·éƒ½ç”±å¹³å°æ”¯æŒè€…ç»Ÿä¸€å»é€‚é…å¥½äº†ã€‚
å¯¹äºESP8266å¼€å‘æ¿ï¼Œä½¿ç”¨Arduinoå¼€å‘ä¹Ÿå¾ˆæ–¹ä¾¿ï¼Œä¸è¿‡PlatformIOæ”¯æŒå¾—æ›´å¥½ï¼Œæä¾›äº†Arduinoï¼ŒNonOS-SDKï¼ŒRTOS-SDKçš„å¼€å‘æ–¹å¼ï¼Œåªè¦æŠŠå¹³å°æ›´æ–°å¥½å°±å¯ä»¥å¼€å§‹å†™userä»£ç äº†ï¼Œéå¸¸æ–¹ä¾¿ã€‚

### PlatformIOä½¿ç”¨æ­¥éª¤
#### 1. å®‰è£…PlatformIO
æ‰“å¼€VSCodeæ‰©å±•æ ï¼Œæœç´¢PlatformIOï¼Œç„¶åå®‰è£…ï¼Œç­‰å¾…å®‰è£…æˆåŠŸåé‡æ–°åŠ è½½å³å¯ï¼Œå®‰è£…æˆåŠŸåå·¦ä¾§å¤šå‡ºä¸€ä¸ªèš‚èšå¤´æ ·çš„æ ç›®ã€‚

#### 2. å®‰è£…å¹³å°æ”¯æŒ 
æ‰“å¼€PIO Home > Platformsï¼Œ å»Embeddedæ æœç´¢ESPï¼Œå°±ä¼šå‡ºæ¥Espressif 8266ï¼Œç‚¹å³ä¸Šæ–¹installå³å¯å®‰è£…å¹³å°æ”¯æŒã€‚

#### 3. åˆ›å»ºé¡¹ç›®
åœ¨PIO Home > Home, ç‚¹å‡» New Projectï¼Œ å°±å¯ä»¥åˆ›å»ºé¡¹ç›®ï¼Œåˆ›å»ºçš„æ—¶å€™Boardä¸€æ å¯ä»¥æ ¹æ®æƒ…å†µé€‰ä¸ªï¼Œæ¯”å¦‚NodeMCUï¼ŒFrameworkä¸€æ æ˜¯æŒ‡å®šè½¯ä»¶æ¡†æ¶çš„ï¼Œå¯ä»¥æ ¹æ®æƒ…å†µé€‰æ‹©Arduino(å…¼å®¹Arduino)ï¼ŒNonOS(ä¸å¸¦RTOS)ï¼ŒRTOS(å¸¦RTOS),é€‰æ‹©å®Œæˆç­‰å¾…é…ç½®å®Œæˆï¼Œå°±å¯ä»¥å¼€å‘é¡¹ç›®äº†ã€‚ä¹Ÿå¯ä»¥ç‚¹Project Examplesï¼ŒæŸ¥çœ‹è‡ªå¸¦çš„ç¤ºä¾‹ã€‚

#### 4. Hello Arduino
åˆ›å»ºäº†ä¸€ä¸ªArduinoé¡¹ç›®ï¼Œåœ¨src/main.cppä¸­ç¼–å†™ä»£ç å³å¯ï¼Œå’Œåœ¨Arduino IDEä¸­ç¼–å†™æ˜¯ä¸€æ ·çš„ï¼Œä¸è¿‡åœ¨å¤´éƒ¨è¦åŠ ä¸Š #include "Arduino.h" ã€‚
```
#include "Arduino.h"
#include "ESP8266WiFi.h"

void setup() {
    // initialize LED digital pin as an output.
    pinMode(LED_BUILTIN, OUTPUT);
    // åˆå§‹åŒ–ä¸²å£
    Serial.begin(115200);
    Serial.println("Arduino Begin!!");

    WiFi.mode(WIFI_STA);
    WiFi.disconnect();
}

void loop() {
    // turn the LED on (HIGH is the voltage level)
    digitalWrite(LED_BUILTIN, HIGH);
    Serial.println("\n\n---Scan Wifi-------------");
    int n = WiFi.scanNetworks();
    for (int i = 0; i < n; i++) {
        Serial.printf("%02d: %s, Ch:%d (%ddBm) %s\n", i + 1,
                      WiFi.SSID(i).c_str(), WiFi.channel(i), WiFi.RSSI(i),
                      WiFi.encryptionType(i) == ENC_TYPE_NONE ? "" : "*");
    }
    Serial.println("---Wifi End-------------\n\n");
    // wait for a second
    delay(6000);
    // turn the LED off by making the voltage LOW
    digitalWrite(LED_BUILTIN, LOW);
    // wait for a second
    delay(20);
}

```

#### 5. ä½¿ç”¨æŠ€å·§
* æ¯ä¸ªé¡¹ç›®çš„é‡è¦é…ç½®ï¼Œä¸»è¦ä¿å­˜åœ¨platformio.iniæ–‡ä»¶ä¸­ï¼Œå¯ä»¥æŒ‡å®šå¹³å°ï¼Œæ¿å¡ï¼Œè½¯ä»¶æ¡†æ¶ï¼Œä¸²å£çƒ§å†™é€Ÿç‡ï¼Œä¸²å£ç»ˆç«¯æ³¢ç‰¹ç‡ç­‰ï¼Œä¾‹å¦‚ï¼š
```
[env:nodemcuv2]
platform = espressif8266
board = nodemcuv2
framework = arduino
upload_speed = 921600
monitor_speed = 115200
```

* ä»£ç å†™å®Œåéœ€è¦è¿è¡Œåªéœ€è¦ç‚¹ä¸‹æ–¹çš„å‘å³ç®­å¤´â†’ï¼Œå³å¯å®Œæˆç¼–è¯‘å’Œçƒ§å†™ï¼Œå’ŒArduino IDEç±»ä¼¼ã€‚ç‚¹ä¸‹æ–¹æ’å¤´å›¾æ ‡ğŸ”Œï¼Œå³å¯æ‰“å¼€ä¸²å£ç»ˆç«¯æŸ¥çœ‹æ¶ˆæ¯

* VSCodeä»£ç æ ¼å¼åŒ–æ ·å¼è®¾ç½®ï¼šé»˜è®¤çš„ä»£ç æ ¼å¼åŒ–æ˜¯VSæ ·å¼ï¼Œå¦‚ä¸‹ï¼š
```
int test()
{
    int i = 3;
    if (i == 3)
    {
        i = 4;
    }
    else if (i == 4)
    {
        i = 3;
    }
}
```
è¿™æ ·å­æ¯”è¾ƒå è¡Œæ•°ï¼Œæˆ‘ä»¬ä¸€èˆ¬ä¹ æƒ¯LLVMæ ·å¼ï¼Œåªè¦åœ¨è®¾ç½® > æ‰©å±• > C/C++ > C_Cpp: Clang_format_style
ä¿®æ”¹è®¾ç½®ä½LLVMå³å¯ï¼Œå†ä½¿ç”¨Alt + Shift + F æ ¼å¼åŒ–ä»£ç ï¼Œå³å¯å˜æˆç´§å‡‘å‹ã€‚
```
int test() {
  int i = 3;
  if (i == 3) {
    i = 4;
  } else if (i == 4) {
    i = 3;
  }
}
```
å¦‚æœå«Œè¿™æ ·TABç©ºæ ¼å¤ªçŸ­ï¼Œå¯ä»¥æŒ‡å®šä¸ºä¸‹é¢ä»£ç ï¼š
```
{ BasedOnStyle: LLVM, IndentWidth: 4 }
```
ç©ºæ ¼é•¿ä¸€ç‚¹äº†ï¼Œä»£ç è¾ƒçŸ­çš„è¯çœ‹èµ·æ¥èˆ’æœä¸€äº›
```
int test() {
    int i = 3;
    if (i == 3) {
        i = 4;
    } else if (i == 4) {
        i = 3;
    }
}
```